# ğŸ¤ Speaker Diarization API

<div align="center">

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

pyannote/speaker-diarization-3.1 çš„ HTTP API å°è£…

</div>

> æœ¬é¡¹ç›®åŸºäº [pyannote/speaker-diarization-3.1](https://huggingface.co/pyannote/speaker-diarization-3.1) å¼€å‘ï¼Œæä¾›äº†ä¾¿æ·çš„ HTTP API æ¥å£ã€‚

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- ğŸ¯ åŸºäº pyannote/speaker-diarization-3.1 çš„é«˜ç²¾åº¦è¯´è¯äººåˆ†ç¦»
- ğŸ”„ å¼‚æ­¥ä»»åŠ¡å¤„ç†
- ğŸ’¾ Redis ä»»åŠ¡é˜Ÿåˆ—å’Œç»“æœå­˜å‚¨
- ğŸ³ Docker æ”¯æŒï¼Œä¸€é”®éƒ¨ç½²

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
docker pull baoweiwei2/speaker-diarization:latest
docker run -d \
    -p 9001:9001 \
    -e HF_TOKEN=your_huggingface_token \
    -e REDIS_HOST=your_redis_host \
    -e REDIS_RESULT_EXPIRE=3600 \
    baoweiwei2/speaker-diarization
```

### æ–¹å¼äºŒï¼šæœ¬åœ°éƒ¨ç½²

1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/baoweiwei12/speaker-diarization-http.git
cd speaker-diarization-http
```

2. è¿è¡Œå®‰è£…è„šæœ¬
```bash
chmod +x install.sh
./install.sh
```

3. é…ç½®ç¯å¢ƒå˜é‡
åˆ›å»º `.env` æ–‡ä»¶å¹¶è®¾ç½®ä»¥ä¸‹å˜é‡ï¼š
```env
HF_TOKEN=your_huggingface_token
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_RESULT_EXPIRE=3600
```

4. å¯åŠ¨æœåŠ¡
```bash
python main.py
```

## ğŸ“ API ä½¿ç”¨è¯´æ˜

### API æ–‡æ¡£

è®¿é—® `/docs` è·¯å¾„å¯ä»¥æŸ¥çœ‹å®Œæ•´çš„ Swagger API æ–‡æ¡£ï¼š
```
http://localhost:9001/docs
```

### 1. æäº¤éŸ³é¢‘æ–‡ä»¶è¿›è¡Œè¯´è¯äººåˆ†ç¦»

```bash
curl -X POST "http://localhost:9001/diarize" \
     -H "accept: application/json" \
     -H "Content-Type: multipart/form-data" \
     -F "file=@your_audio.wav"
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
    "task_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

### 2. è·å–å¤„ç†ç»“æœ

```bash
curl -X GET "http://localhost:9001/result/{task_id}" \
     -H "accept: application/json"
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
    "status": "done",
    "start_time": 1678901234,
    "end_time": 1678901235,
    "result": [
        {
            "start": 0.0,
            "end": 2.5,
            "speaker": "SPEAKER_00"
        },
        {
            "start": 2.5,
            "end": 5.0,
            "speaker": "SPEAKER_01"
        }
    ]
}
```

## ğŸ”§ é…ç½®è¯´æ˜

åœ¨ `.env` æ–‡ä»¶ä¸­å¯ä»¥ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

- `HF_TOKEN`: HuggingFace API Token
- `REDIS_HOST`: Redis æœåŠ¡å™¨åœ°å€
- `REDIS_PORT`: Redis æœåŠ¡å™¨ç«¯å£
- `REDIS_RESULT_EXPIRE`: ç»“æœç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ MIT åè®® - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

---

